{"name":"RNASkim","tagline":"RNA-Skim: a rapid method for RNA-Seq quantification at transcript level","body":"RNASkim\r\n=======\r\n\r\nRNA-Skim: a rapid method for RNA-Seq quantification at transcript level\r\n\r\n\r\n## Clustering the transcripts based on their sequence similarities. \r\n\r\nTODO(zzj)\r\n\r\n## Building the index for a given transcript clustering result\r\n\r\nThis command downloads a clustering result of the mouse transcriptome. \r\n<pre>\r\nwget http://www.csbio.unc.edu/rs/clustered_gene.fa\r\n</pre>\r\n\r\nThe clustered_gene.fa file uses fasta format, but it may contain more than one transcript per two lines, for example:\r\n\r\n<pre>>gid|tid1|tid2\r\nATCTATTA|TACTAATC\r\n</pre> \r\n\r\nThis presents a transcript cluster named gid which contains two transcripts tid1 and tid2. And the sequence of tid1 is ATCTATTA and the sequence of tid2 is TACTAATC. \"|\" is the delimiter for both the sequence ids and the sequences. And the first id of the sequence ids is the gene id.\r\n\r\nNow you can run the following command to find all sig-mer regions.\r\n\r\n<pre>./rs_index -transcript_fasta=clustered_gene.fa -index_file=clustered_gene.fa.pb -num_threads 4</pre>\r\n\r\nA sig-mer region is a sequence that all k-mers from the region are sig-mers of the transcript cluster. (Check out the document for the GeneSignatures class at rnasigs.proto for more details). The clustered_gene.fa.pb contains the corresponding GeneSignatures class for every transcript cluster. The storage format is at [Storage format for protobuf in RNA-Skim](https://github.com/zzj/rnasigs/wiki/Code-Structure#wiki-storage-proto_datah).\r\n\r\nThe default sig-mer size is 40. \r\n\r\n<pre>./rs_index -transcript_fasta=clustered_gene.fa -index_file=clustered_gene.fa.pb -rs_length 50 -num_threads 4</pre>\r\n\r\nYou can check all arguments information by\r\n\r\n<pre>./rs_index --help </pre>\r\n\r\n**The \"--help\" parameter also works for other executables.** The output list all parameters into different sections by their source files, and only the parameters defined in the RNA-Skim sources (the file names start with \"rs_\") are defined by RNA-Skim. Or you can run \r\n\r\n<pre>./rs_index --helpshort\r\n./rs_select --helpshort\r\n./rs_count --helpshort\r\n./rs_estimate --helpshort\r\n</pre>\r\n\r\nto filter out all unnecessary parameters.\r\n\r\n## Selecting sig-mers from the sig-mer regions\r\n\r\nOK, now you have the clustered_gene.fa.pb file. Let's select sig-mers from all sig-mer regions:\r\n\r\n<pre>./rs_select -index_file=clustered_gene.fa.pb -selected_keys_file=clustered_gene.fa.sk</pre>\r\n\r\n**If you use sig-mer size other than the default value, you should specify the length in the parameter list as well,** for example:\r\n\r\n<pre>./rs_select -index_file=clustered_gene.fa.pb -selected_keys_file=clustered_gene.fa.sk  -rs_length 50</pre>\r\n\r\nPlease be careful about this. This is annoying and should be [fixed](https://github.com/zzj/rnasigs/issues/14). \r\n\r\nYou may see some warnings like this,\r\n\r\n<pre>E0309 21:20:25.820291 1990034192 rs_select.cc:130] ENSMUST00000114890 has 1 rna_signatures. Skipped.</pre>\r\n\r\nFor some transcripts, RNA-Skim cannot get enough number of sig-mers, so it does not quantify such transcripts because the results of those transcripts are not reliable. Most of such transcripts are either too short (less than 150 bps) or categorized as \"predicted gene\".\r\n\r\nThe output file (clustered_gene.fa.sk) is a list of SelectedKey objects. For details, please checkout the comments for SelectedKey at rnasigs.proto.\r\n\r\n## Simulating the RNA-Seq data\r\n\r\nPlease run the download.py file first ([Internal Development Guide](https://github.com/zzj/rnasigs/wiki/Internal-Development-Guide)). Remember to clean up the gtf file (details at the internal develop guide)\r\n\r\nWe use [Flux simulator](http://sammeth.net/confluence/display/SIM/Home) to simulate RNA-Seq data. If you have run bootstrap.sh command, it should be installed at lib/flux-simulator-1.2. If not, please file an issue and fix bootstrap.sh file. \r\n\r\nThe following command generates a test data of 1million paired reads\r\n\r\n<pre>cd ..\r\nmkdir test\r\ncp simulation/test.par test\r\ncd test\r\nexport FLUX_MEM=\"6G\";\r\n../lib/flux-simulator-1.2/bin/flux-simulator -p test.par\r\n</pre>\r\n\r\nNow, we have four extra files (test.bed, test.fastq, test.lib, test.pro). The two most important files are test.fastq (RNASeq fastq files) and the test.pro (the simulated abundance values. More details at [here](http://sammeth.net/confluence/display/SIM/.PRO+Transcriptome+Profile)).\r\n\r\nThis command split the fastq files into two fasta files (test.fastq_1  and test.fastq_2) and two fastq files (test.fastq_1.fastq and test.fastq_2.fastq).\r\n\r\n<pre>\r\npython ../simulation/split_fasta.py test.fastq\r\n</pre>\r\n\r\nFor more details, check out the web site of the flux simulator.\r\n\r\n## Counting the sig-mers for a given RNA-Seq dataset\r\n\r\nNow, we run rs_count to count all sig-mers stored in the clustered_gene.fa.sk file.\r\n\r\n<pre>GLOG_logtostderr=1  ../src/rs_count  -selected_keys_file=clustered_gene.fa.sk -count_file=clustered_gene.fa.cf -read_files1=../test/test.fastq_1 -read_files2=../test/test.fastq_2 -num_threads=1 -rs_length (INPUT_YOUR_SIG_MER_LENGTH_HERE)</pre>\r\n\r\nThis generates clustered_gene.fa.cf file, which is almost identical with the clustered_gene.fa.sk file, but the count fields in the SelectedKey object in the clustered_gene.fa.cf file is the real occurrences of their corresponding sig-mers.\r\n\r\n## Quantifying the abundances of transcripts\r\n\r\nThis command quantifies the transcriptome based on the counts of sig-mers in the clustered_gene.fa.cf file.\r\n<pre>\r\n../src/rs_estimate -count_file=clustered_gene.fa.cf > estimation\r\n</pre>\r\n\r\nThere are four columns in the estimation file: transcript id; the length of the transcript; estimated number of relative reads; RPKM value of the transcript.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}